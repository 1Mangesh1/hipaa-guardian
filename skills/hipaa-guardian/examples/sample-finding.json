{
  "findings": [
    {
      "id": "F-20260128-0001",
      "timestamp": "2026-01-28T12:00:00Z",
      "file": "data/patient_records.json",
      "line": 42,
      "column": 15,
      "field": "patient.ssn",
      "detected_value_hash": "sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",
      "context": "...Patient reported SSN [REDACTED] and DOB...",
      "context_before": "\"notes\": \"",
      "context_after": " during intake\"",
      "classification": "PHI",
      "identifier_type": "ssn",
      "detected_by": [
        {
          "method": "regex_ssn_standard",
          "pattern": "\\b\\d{3}-\\d{2}-\\d{4}\\b",
          "version": "1.0"
        }
      ],
      "confidence": 0.98,
      "risk_assessment": {
        "overall_score": 92,
        "severity": "critical",
        "factors": {
          "sensitivity": {
            "score": 100,
            "rationale": "SSN - universal identifier"
          },
          "exposure": {
            "score": 75,
            "rationale": "Internal application data file"
          },
          "volume": {
            "score": 85,
            "rationale": "Part of dataset with 150+ records"
          },
          "identifiability": {
            "score": 100,
            "rationale": "Direct identifier"
          }
        }
      },
      "hipaa_mapping": [
        {
          "rule": "Privacy Rule",
          "section": "164.514(b)(2)(i)(G)",
          "description": "Social Security numbers are one of 18 identifiers that must be removed for de-identification",
          "source": "HHS"
        },
        {
          "rule": "Security Rule",
          "section": "164.312(a)(1)",
          "description": "Access control - ePHI must be protected with access controls",
          "source": "HHS"
        },
        {
          "rule": "Breach Notification Rule",
          "section": "164.402",
          "description": "If accessed by unauthorized party, would constitute breach requiring notification",
          "source": "HHS"
        }
      ],
      "remediation_steps": [
        {
          "priority": 1,
          "action": "Remove or hash the SSN value",
          "details": "Replace SSN with SHA-256 hash or remove entirely if not needed for business purpose"
        },
        {
          "priority": 2,
          "action": "Implement access controls",
          "details": "Ensure file is only accessible to authorized personnel with legitimate need"
        },
        {
          "priority": 3,
          "action": "Add encryption at rest",
          "details": "Encrypt the data file using AES-256 encryption"
        },
        {
          "priority": 4,
          "action": "Enable audit logging",
          "details": "Log all access to this file for compliance monitoring"
        },
        {
          "priority": 5,
          "action": "Review data retention",
          "details": "Determine if SSN is required; if not, remove from data model"
        }
      ],
      "evidence_refs": [
        {
          "id": "E-20260128-0001",
          "type": "file_snapshot",
          "path": "evidence/F-20260128-0001/snapshot.json.enc",
          "hash": "sha256:abc123..."
        }
      ],
      "status": "open",
      "assignee": null,
      "created_at": "2026-01-28T12:00:00Z",
      "updated_at": "2026-01-28T12:00:00Z"
    },
    {
      "id": "F-20260128-0002",
      "timestamp": "2026-01-28T12:00:05Z",
      "file": "src/tests/fixtures/test_data.py",
      "line": 87,
      "column": 20,
      "field": "test_patient['dob']",
      "detected_value_hash": "sha256:d4735e3a265e16eee03f59718b9b5d03019c07d8b6c51f90da3a666eec13ab35",
      "context": "test_patient = {'name': '[REDACTED]', 'dob': '[REDACTED]', 'ssn': '[REDACTED]'}",
      "classification": "PHI",
      "identifier_type": "dob",
      "detected_by": [
        {
          "method": "regex_date_mmddyyyy",
          "pattern": "\\b(0?[1-9]|1[0-2])[-/](0?[1-9]|[12]\\d|3[01])[-/](19|20)\\d{2}\\b",
          "version": "1.0"
        },
        {
          "method": "context_dob_label",
          "pattern": "dob|date_of_birth|birth_date",
          "version": "1.0"
        }
      ],
      "confidence": 0.95,
      "risk_assessment": {
        "overall_score": 68,
        "severity": "medium",
        "factors": {
          "sensitivity": {
            "score": 85,
            "rationale": "DOB - key identifier"
          },
          "exposure": {
            "score": 55,
            "rationale": "Test fixture in source code"
          },
          "volume": {
            "score": 40,
            "rationale": "Single test record"
          },
          "identifiability": {
            "score": 90,
            "rationale": "Combined with name and SSN in same record"
          }
        }
      },
      "hipaa_mapping": [
        {
          "rule": "Privacy Rule",
          "section": "164.514(b)(2)(i)(C)",
          "description": "Dates (other than year) related to an individual must be removed for de-identification",
          "source": "HHS"
        }
      ],
      "remediation_steps": [
        {
          "priority": 1,
          "action": "Replace with synthetic test data",
          "details": "Use Faker library or similar to generate realistic but fake test data"
        },
        {
          "priority": 2,
          "action": "Add to .gitignore if fixture file",
          "details": "Ensure test fixtures with any PHI are not committed to version control"
        }
      ],
      "status": "open",
      "assignee": null,
      "created_at": "2026-01-28T12:00:05Z",
      "updated_at": "2026-01-28T12:00:05Z"
    },
    {
      "id": "F-20260128-0003",
      "timestamp": "2026-01-28T12:00:10Z",
      "file": "config/.env.development",
      "line": 15,
      "column": 1,
      "field": "TEST_PATIENT_SSN",
      "detected_value_hash": "sha256:4e07408562bedb8b60ce05c1decfe3ad16b72230967de01f640b7e4729b49fce",
      "context": "TEST_PATIENT_SSN=[REDACTED]",
      "classification": "PHI",
      "identifier_type": "ssn",
      "detected_by": [
        {
          "method": "regex_ssn_standard",
          "pattern": "\\b\\d{3}-\\d{2}-\\d{4}\\b",
          "version": "1.0"
        },
        {
          "method": "context_env_variable",
          "pattern": "SSN|SOCIAL_SECURITY",
          "version": "1.0"
        }
      ],
      "confidence": 0.99,
      "risk_assessment": {
        "overall_score": 78,
        "severity": "high",
        "factors": {
          "sensitivity": {
            "score": 100,
            "rationale": "SSN - universal identifier"
          },
          "exposure": {
            "score": 60,
            "rationale": "Environment file - may be committed or shared"
          },
          "volume": {
            "score": 25,
            "rationale": "Single value"
          },
          "identifiability": {
            "score": 100,
            "rationale": "Direct identifier"
          }
        }
      },
      "hipaa_mapping": [
        {
          "rule": "Privacy Rule",
          "section": "164.514(b)(2)(i)(G)",
          "description": "Social Security numbers must be removed for de-identification",
          "source": "HHS"
        },
        {
          "rule": "Security Rule",
          "section": "164.312(a)(2)(iv)",
          "description": "Encryption - ePHI should be encrypted",
          "source": "HHS"
        }
      ],
      "remediation_steps": [
        {
          "priority": 1,
          "action": "Remove real SSN from environment file",
          "details": "Replace with format-valid synthetic SSN like 000-00-0000 for testing"
        },
        {
          "priority": 2,
          "action": "Add .env* to .gitignore",
          "details": "Ensure environment files are never committed to version control"
        },
        {
          "priority": 3,
          "action": "Use secrets manager for production",
          "details": "Store sensitive configuration in HashiCorp Vault, AWS Secrets Manager, or similar"
        }
      ],
      "status": "open",
      "assignee": null,
      "created_at": "2026-01-28T12:00:10Z",
      "updated_at": "2026-01-28T12:00:10Z"
    }
  ],
  "summary": {
    "scan_timestamp": "2026-01-28T12:00:00Z",
    "scan_duration_seconds": 12.5,
    "files_scanned": 156,
    "total_findings": 3,
    "by_severity": {
      "critical": 1,
      "high": 1,
      "medium": 1,
      "low": 0,
      "informational": 0
    },
    "by_identifier_type": {
      "ssn": 2,
      "dob": 1
    },
    "by_classification": {
      "PHI": 3,
      "PII": 0,
      "sensitive_nonPHI": 0
    }
  },
  "metadata": {
    "scanner_version": "1.0.0",
    "patterns_version": "2026.01",
    "scan_mode": "synthetic",
    "scan_path": "./",
    "excluded_paths": [
      "node_modules",
      ".git",
      "vendor"
    ]
  }
}
